---
title: Действия
id: версия-2.0.0-действия
original_id: actions
---

Действия - это общая система, позволяющая легко интегрировать систему автоматизации Home Assistant в несколько областей iOS.

# Создание действий

Действия создаются из раздела Действия на странице Настройки приложения в приложении для компаньона. Каждое действие имеет шесть обязательных полей:

* `Name`: имя действия, это будет возвращено в событии [Home Assistant event](https://www.home-assistant.io/docs/configuration/events/) запущено приложением.
* `Text`: описательный текст, показываемый на телефоне и часах. Лучше сохранить это относительно короткое, так как на каждой кнопке действий есть ограниченное пространство.
* `Text Color`: цвет текста, заданного выше
* `Background Color`: цвет кнопки, созданной для действия.
* `Icon`: значок для отображения слева от текста на кнопке действия 
* `Icon Color`: цвет значка на кнопке действия.

Для трех цветных полей цвет выбирается, нажав на круг выбора цвета в каждом поле.

# Использование действий

Когда кнопка действия нажата `ios.action_fired` действие запускается на шине событий Home Assistant. Данные события состоят из словаря атрибутов, форматированных JSON.

| Атрибут      | Значение                                                                                                                                                                                                                                                  |
| ------------ | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `context`    | Дочерний словарь, связанный с пользователем, который вызвал событие и ID события                                                                                                                                                                          |
| `data`       | Дочерний словарь, содержащий ключевую информацию о действии и его происхождении                                                                                                                                                                           |
| `event_type` | Всегда `ios.action_fired`                                                                                                                                                                                                                                 |
| `origin`     | Всегда `REMOTE`                                                                                                                                                                                                                                           |
| `time_fired` | Данные и время, когда действие было запущено, отформатировано как [ISO timestamp](https://en.wikipedia.org/wiki/ISO_8601) , например, в полночь, в день Рождества, в Лапландии (восточноевропейское время, UTC+2), будет `2019-12-25T00:00.000000+02:00`. |

Атрибуты, содержащиеся в данных `data`:

| Атрибут                   | Значение                                                                                                                                                                                  |
| ------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `actionID`                | Уникальный идентификатор параметра.                                                                                                                                                       |
| `actionName`              | Имя действия, указанное в поле `Name` при создании действия.                                                                                                                              |
| `sourceDeviceID`          | ID устройства установлен на странице Настройки приложения.                                                                                                                                |
| `sourceDeviceName`        | Имя iPhone или iPad, из которых действие было инициировано. Это имя устройства, установленное в iOS в Настройках App>General>О программе.                                                 |
| `sourceDevicePermanentID` | Имя iPhone или iPad, из которых действие было инициировано                                                                                                                                |
| `triggerSource`           | В какой части iOS действие было запущено. Либо: ` widget ` для экрана сегодня, ` appShortcut ` для быстрых действий, доступных через 3D-touch или ` watch ` если запущено из Apple Watch. |

Атрибуты, содержащиеся в контексте `context`, являются:

| Атрибут     | Значение                                                                                                                                                                  |
| ----------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `id`        | Уникальный одноразовый ID для события.                                                                                                                                    |
| `parent_id` | Всегда `null`.                                                                                                                                                            |
| `user_id`   | Home Assistant [ID пользователя](https://www.home-assistant.io/docs/authentication/#user-accounts) используется для авторизации приложения с помощью домашнего помощника. |

Действия могут быть использованы для автоматизации в рамках Home Assistant. Пример: `configuration.yaml` может быть запись:

```yaml
automation:
  - alias: "Action Turn Lights Off"
    initial_state: true
    trigger:
      - platform: event
        event_type: ios.action_fired
        event_data:
          actionName: 'Bed Time'
    action:
      service: light.turn_off
      entity_id: group.all_lights
```

Обратите внимание, что атрибуты, расположенные в данных `data` и `context` доступны через `event_data` и `event_context` соответственно в автоматизации.

Вы можете использовать страницу событий в инструментах разработчика Home Assistant чтобы показать информацию содержащуюся в событии для определенного события подписавшись `ios.action_fired` и переключив действия на вашем устройстве.

# Quick Actions на главном экране

[Быстрые действия на домашнем экране](https://support.apple.com/guide/iphone/keep-apps-handy-iph414564dba/ios#iph1ffcbd691) обеспечивают удобный ярлык для ваших действий и доступ к нему через 3D Touching the Home Assistant значок приложения на вашем домашнем экране.

# Виджет "Сегодня"

[Виджет "Сегодня"](https://support.apple.com/en-gb/HT207122) - это другой способ, через который действия могут быть выполнены. Чтобы добавить Home Assistant виджет в ваш текущий вид:

1. Проведите вправо на главном экране или экране блокировки.
2. Прокрутите вниз и нажмите кнопку Редактировать.
3. Найдите виджет "Home Assistant - Actions" в списке "More Widgets" и нажмите на зеленую кнопку + чтобы добавить его.
4. Переставьте, как вам нравится, и затем нажмите Готово.